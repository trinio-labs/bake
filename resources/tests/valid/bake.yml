name: test
environment:
  - TEST_BAKE_VAR
  - CI_BUILD

variables:
  bake_project_var: bar
  envName: dev

overrides:
  test:
    bake_project_var: bar
    envName: test
  dev:
    bake_project_var: dev_bar
  prod:
    bake_project_var: prod_bar
    envName: prod

config:
  verbose: true
  {{#if (eq env.CI_BUILD "true")}}
  reserved_threads: 0
  {{/if}}
  cache:
    local:
      enabled: true
    remotes:
      s3:
        bucket: trinio-bake-cache-{{var.envName}}
      # gcs:
      #   bucket: trinio-bake-cache
